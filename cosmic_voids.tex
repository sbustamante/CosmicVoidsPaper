\documentclass[a4,useAMS,usenatbib,usegraphicx]{latex/mn2e} 
%\documentclass{latex/emulateapj} 
%External Packages and personalized macros
\include{latex/macros}

\begin{document}

%=========================================================================
%		FRONT MATTER
%=========================================================================
\title{Fractional anisotropy as a tracer of cosmic voids}
\author[S. Bustamante and J.E. Forero-Romero]{
\parbox[t]{\textwidth}{\raggedright 
  Sebastian Bustamante \thanks{sebastian.bustamante@udea.edu.co}$^{1}$,
  Jaime E. Forero-Romero$^{2}$ 
}
\vspace*{6pt}\\
$^1$Instituto de F\'{\i}sica - FCEN, Universidad de Antioquia, Calle
67 No. 53-108, Medell\'{\i}n, Colombia\\ 
$^2$Departamento de F\'{i}sica, Universidad de los Andes, Cra. 1
No. 18A-10, Edificio Ip, Bogot\'a, Colombia
}

\maketitle

\begin{abstract}
Finding and characterizing voids in the large scale structure of the
universe is an important task in cosmological studies. 
In this paper we present a novel approach to find voids in
cosmological simulations.  
It is based on algorithms that use the tidal and the
velocity shear tensors to define the cosmic web.
Voids are identified using the fractional anisotropy (FA) computed
from the eigenvalues of each web scheme. We define the void boundaries
using a watershed transform based on the local minima of the FA; the
boundaries are regions where the FA is maximized, corresponding to
walls and filaments.  This void definition does not have any free
parameter and does not make any assumption on the shape or structure
of the voids.  We test the method on the Bolshoi simulation and report
on the density and velocity profiles for the voids found using this
new scheme.
\end{abstract}

\begin{keywords}
Cosmology: theory - large-scale structure of Universe -
Methods: data analysis - numerical - N-body simulations
\end{keywords}


%=========================================================================
%		PAPER CONTENT
%=========================================================================

%*************************************************************************
\section{Introduction}
\label{sec:introduction}
%*************************************************************************


Since voids where discovered in the first compiled galaxy surveys 
\citep{Chincarini75, Gregory78, Einasto80M, Einasto80N, Kirshner81, 
Kirshner87}, they have been identified, along with the filamentary and 
hierarchically clustered nature of the Cosmic Web, as one of the most 
striking features of the Megaparsec Universe \citep{Bond96}. Nevertheless,
due to the large volume extension of void regions ($\sim 5-10\ \mbox{Mpc} 
h^{-1}$), statistically meaningful catalogues of voids \citep{Pan10, 
Sutter12b, Nadathur14} only have become available after modern large 
galaxy surveys like the two-degree field Galaxy Redshift Survey \citep{
Colless01, Colless03} and the Sloan Digital Sky Survey \citep{York00,
Abazajian03}, thereby triggering a plethora of more refined observational 
and statistical studies of voids throughout the last decade \citep{Hoyle04,
Croton04, Rojas05, Ceccarelli06, Patiri06a, Tikhonov06, Patiri06b, 
Tikhonov07, BendaBeckmann08, Foster09, Ceccarelli13, Sutter14a}


On the theoretical side, early descriptions of the evolution of the 
large-scale Universe, based on gravitational instabilities in primordial 
stages and leaded by the seminal work of \citet{Zeldovich70}, are 
consistent with the Cosmic Web picture, where planar pancake-like regions 
of matter enclose enormous underdense voids and are bordered, in turn, by 
thin filaments and high-density clumpy knots \citep{Bond96}. First 
theoretical models for describing formation, dynamics and properties of 
voids \citep{Hoffman82, Icke84, Bertschinger85, Blumenthal92} were 
dramatically complemented and extended by first numerical studies based 
on simulations \citep{Martel90, Regos91, Weygaert93, Dubinski93}. This 
tendency of using numerical data from N-body simulations, fuelled by last 
generation computing systems and ever more efficient numerical algorithms, 
has become increasingly common in the last years as a powerful analysis 
toolkit of cosmic voids (for an extensive compilation of previous 
numerical works, see \citet{Colberg08}).


At present, studying voids may be considered as a threefold enterprise
\citep{Platen07}: first, they are a key ingredient of the Cosmic Web as 
they dominate almost the entire volume distribution at large-scales and 
additionally, they compensate overdense structures in the total budget of 
matter. This implies that a full understanding of their evolution and 
properties is essential for fathoming the high complexity of the Cosmic 
Web. Second, they provide a valuable resource for inferring and probing 
cosmological parameters as their structure and dynamics are highly 
determined by these values. Third, they constitute and unique and still 
largely pristine environment in which can be tested galaxy evolution.


Although a visual recognition of voids in galaxy surveys and simulations
is possible in most cases, a formal systematic identification is necessary 
for statistically meaningful studies. However, a basic yet essential issue 
remains regarding the definition itself of what a void is. There is not a 
general consensus about an unambiguous definition of cosmic voids and 
therefore, there can be found many different void finding techniques 
throughout the literature (for a detailed comparison of different schemes, 
see the Void Finder Comparison Project \citet{Colberg08}). In spite of the 
diversity of existing schemes, they can be roughly classified into two 
main types: first, geometric schemes based on point spatial or redshift 
distribution of galaxies in surveys or catalogues of dark matter halos in 
simulations \citep{Kauffmann91, Muller00, Gottlober03, Hoyle04, Brunino07, 
Foster09, Micheletti14, Sutter14}, and second, schemes based on the smooth 
and continuous matter density field either from simulations or from 
reconstruction procedures on surveys \citep{Plionis02, Colberg05, 
Shandarin06, Platen07, Neyrinck08, Neyrinck13, Ricciardelli2013}.


Here we introduce a new tracer of the structure of cosmic voids built from 
two tensorial web schemes, i.e. the T-web, based on the Hessian of the 
gravitational potential or tidal tensor \citep{Hahn07, Forero09}, and the 
V-web, based on the velocity shear tensor \citep{Hoffman12}. These web 
schemes classify the Cosmic Web into four different types of environment
depending on the counting of the number of eigenvalues below an 
user-defined threshold ($\lambda_{th}$), namely voids (3 eigenvalues below
$\lambda_{th}$), sheets (2), filaments (1) and knots or clusters (0).
The tidal and the shear tensors have proven to be more fundamental than 
the density field as they also trace the collapsing or expanding nature of 
the matter field, which ultimately is what defines the underlying dynamics 
of the Cosmic Web. Furthermore, the density field is degenerated regarding 
the defined types of environment \citep{Hahn07}, which implies that is not 
possible to assign a priori a range of density values to each of them. 
This yields that the usually adopted definition of voids as simply 
underdense regions in the large-scale matter distribution, is not precise 
enough as it excludes a proper description of the internal structure of 
voids.


Following the recent trend of using digital image-processing techniques 
developed in other disciplines (e.g. medical sciences and computer imaging) 
for analysing the structure of the Cosmic Web, we propose here, much in 
the same way as \citet{Libeskind13}, the fractional anisotropy (FA) as a 
tracer of the internal structure and the outline of cosmic voids. The FA 
was initially introduced by \citet{Basser95} for quantifying the 
anisotropy degree of the diffusivity of water molecules through cerebral
tissue in nuclear magnetic resonance imaging. In this context we use the 
same quantity for determining the anisotropy degree of the local 
environment from either the orbital dynamics as set by the eigenvalues of
the tidal tensor (T-web), or the dynamics of the velocity field as set by 
the eigenvalues of the shear tensor (V-web). In both cases, the FA is not
determined directly from the density field, hence it is suitable for 
describing both, the structure of high non-linear regions (e.g. filaments,
knots and very dense walls) as well as for revealing the fainter 
substructure exhibited by quasi-linear regions like voids.


Once established the FA as the tracer field of cosmic voids, we proceed to
identify individual voids as basins of local minima. For this purpose we
implement a technique defined by \citet{Beucher79} and \citet{Beucher93} 
and widely used in the field of image analysis and mathematical morphology, 
i.e. the \textit{watershed transform algorithm}. This technique has been 
already implemented on void finding schemes by \citet{Platen07} and 
\citet{Neyrinck08} with very interesting results, where individual voids 
are identified as catching basins of local minima of the density field. 
The appeal of this algorithm lies in that is parameter-free and does not 
require to make any assumption on the shape and morphology of voids. 
Although we use a \textit{cloud-in-cell} (\texttt{CIC}) algorithm on a 
Cartesian mesh for estimating the density and tensor fields, instead of 
the more sophisticated \textit{Delaunay tessellation for field estimator} 
(\texttt{DTFE}) technique \citep{Schaap00}, our implementation of the 
watershed transform should not be significantly affected as we are 
interested in quasi-linear regions where the \texttt{CIC} gives similar 
estimations.


This paper is organized as follows. In section 2 we describe the used
simulation for testing our void finding algorithm, i.e. the Bolshoi
simulation. Alternatively to the web schemes T-web and V-web, we propose 
a very basic web classifier based on three threshold values defined on the
density field, this is used in our comparisons as a representative of all 
density-based schemes. A detailed description of these schemes is 
presented in section 3. In section 4 we describe how the FA can be used 
for tracing the structure of voids. Once obtained meaningful catalogues of 
voids for each scheme, we proceed to compare some typical and general 
interest properties of voids such as volume functions, distributions of 
size and density and velocity profiles. This is done in section 5. Finally
in section 6 we analyse and evaluate our findings.



%*************************************************************************
\section{The Simulation}
\label{sec:the_simulation}
%*************************************************************************


We use here an unconstrained cosmological simulation (the Bolshoi 
simulation) to identify the possible large scale environment and the 
distribution of cosmic voids at $z=0$. The Bolshoi simulation follows the 
non-linear evolution of a dark matter density field on a cubic volume of 
size $250$\hMpc sampled with $2048^3$ particles. The cosmological 
parameters in the simulation are $\Omega_{\rm m}=0.27$, $\Omega_{\Lambda}
=0.73$, $h=0.70$, $n=0.95$ and $\sigma_{8}=0.82$ for the matter density, 
cosmological constant, dimensionless Hubble parameter, spectral index of 
primordial density perturbations and normalization for the power spectrum
respectively, consistent with the seventh year of data of the Wilkinson 
Microwave Anisotropy Probe (WMAP) \citep{Jarosik11}. For more detailed 
technical information about the simulation, see \citet{Klypin11}.


With the above parameters the mass of each particle in the simulation is 
$m_{\rm p}=1.4\times 10^{8}$\hMsun. Throughout this paper we shall use a
catalogue of halos identified through the Bound Density Maximum algorithm
\citep{Klypin99}. These halos have been selected to have an overdensity of
200 times the critical density in addition to be mutually excluded of the
virial radius of other halos. Mass, comoving position and peculiar 
velocity of each halo at $z=0$ were obtained through the public available 
Multidark database \footnote{\url{http://www.multidark.org/MultiDark/}} 
\citep{Riebe11}. For estimating the density and velocity fields we use a 
\textit{cloud-in-cell} (\texttt{CIC}) algorithm onto a grid of $256^3$ 
cells, corresponding to a resolution of $0.98$\hMpc per cell side. Then, 
through finite-differences and FFT methods the tidal and shear tensors 
are computed. Finally the eigenvalues and eigenvectors of each tensor are
obtained for each cell of the grid. Neglecting substructures presented 
below Megaparsec scales and taking into account our focus in voids, which
are a prominent characteristic of the Megaparsec Universe, we apply a 
Gaussian softening of one cell to all fields.



%*************************************************************************
\section{Algorithms to quantify the Cosmic Web}
\label{sec:algorithms_cosmic_web}
%*************************************************************************


%-------------------------------------------------------------------------
\subsection{The tidal web (T-web)}
\label{subsec:Tweb}
%-------------------------------------------------------------------------


This scheme was initially proposed by \citet{Hahn07} as a novel 
alternative for classifying the Cosmic Web based on the tidal tensor, 
that is somehow more fundamental than the density field as it also allows 
to quantify the orbital dynamics of the matter field. This approach is 
reached by a second-order expansion of the equations of motion around 
local minima of the gravitational potential and then extended to any 
position. The second-order term corresponds to the tidal tensor, which is 
defined as the Hessian of the normalized gravitational potential


%.........................................................................
%Tidal Tensor
\eq{V_web}
{	T_{\alpha\beta} = \frac{\partial^2\phi}{\partial x_{\alpha}\partial x_{\beta}}	}
%.........................................................................
where the physical gravitational potential has been rescaled by a factor 
$4\pi G\bar{\rho}$ in such a way that $\phi$ satisfies the following 
equation


%.........................................................................
%Poisson
\eq{Poisson}
{	\nabla^2\phi = \delta,	}
%.........................................................................
with $\bar{\rho}$ the average density in the Universe, $G$ the 
gravitational constant and $\delta$ the dimensionless matter overdensity.


Since the tidal tensor can be represented in any cell by a real and 
symmetric $3\times 3$ matrix, it is ensured the possibility to diagonalize 
it and obtain three real eigenvalues $\lambda_{1}\geq\lambda_{2}\geq
\lambda_3$. This set of eigenvalues can be used as indicators of the local 
orbital stability in each proper direction, which in turn can be 
translated into a classification scheme of the Cosmic Web. A counting of 
the number of positive (stable) or negative (unstable) eigenvalues allows 
to catalogue a single cell into one of the next four types of environment: 
voids (3 negatives eigenvalues), sheets (2), filaments (1) and knots (0). 
A significant improvement to this scheme was introduced by \citet{Forero09}
by means of a relaxation of the stability criterion. The relative strength 
of each eigenvalue is no longer defined by the sign, but instead by a
threshold value $\lambda_{th}$ that can be tuned in such a way that the
visual impression of the web-like matter distribution is reproduced.



%-------------------------------------------------------------------------
\subsection{The velocity web (V-web)}
\label{subsec:Vweb}
%-------------------------------------------------------------------------


We also use a kinematical scheme to define the Cosmic Web environment in 
the simulation. The scheme has been thoroughly described in 
\citet{Hoffman12} and applied to study the shape and spin alignment in the
Bolshoi simulation in \citet{Libeskind13}. We refer the reader to these 
papers to find a detailed description of the algorithm, its limitations 
and capabilities. The V-web scheme for environment finding is based on the
local velocity shear tensor calculated from the smoothed dark matter 
velocity field in the simulation. The central quantity is given by the 
following dimensionless expression


%.........................................................................
%V-Web Definition
\eq{V_web}
{	\Sigma_{\alpha\beta} = -\frac{1}{2H_0}\pr{\frac{\partial v_{\alpha}}
{\partial x_{\beta}}+\frac{\partial v_{\beta}}{\partial x_{\alpha}}}	}
%.........................................................................
where $v_{\alpha}$ and $x_{\alpha}$ represent the $\alpha$ component of 
the comoving velocity and position, respectively. Like the tidal tensor, 
$\Sigma_{\alpha\beta}$ can be represented by a $3\times 3$ symmetric 
matrix with real values, hence diagonalizing it is obtained three real 
eigenvalues $\lambda_{1}\geq\lambda_{2}\geq\lambda_3$ whose sum (the 
trace of $\Sigma_{\alpha\beta}$) is proportional to the divergence of the 
local velocity field smoothed on the physical scale ${\mathcal R}$. 


In the same way, the relative strength of the three eigenvalues with 
respect to a threshold value $\lambda_{th}$ allows for the local 
classification of the matter distribution into the previous four web types. 
For the threshold choosing in both schemes, the V-web and the T-web, it is
usual to fine-tuning the value in such a way that the visual appearance of
the Cosmic Web as seen in simulations and galaxy surveys is reproduced. 
However, we do not take this approach here, instead we propose a novel 
approach for the threshold choosing based on the maximization of the 
fractional anisotropy field occurring in filaments and very dense walls.


%.........................................................................
%FIGURE 1: Distributions of FA and density regarding the Lambda_1 eigenvalue
\begin{flushleft}
\begin{figure*}
\centering
  \includegraphics[trim = 2mm 2mm 5mm 6mm, clip, keepaspectratio=true,
  width=0.3\textheight]{./figures/cosmicweb_volume_Tweb.pdf}
  \includegraphics[trim = 2mm 2mm 5mm 6mm, clip, keepaspectratio=true,
  width=0.3\textheight]{./figures/cosmicweb_volume_Vweb.pdf}  
  
  \captionof{figure}{\small Volume Filling Fraction for each type of 
  environment with respect to the chosen threshold $\lambda_{th}$ for both
  web schemes (T-web, left panel. V-web, right panel). For each case, the 
  threshold value is chosen such that the fractional anisotropy along the 
  void-sheet boundaries has a value of $FA=0.95$.}

  \label{fig:VFF}
  \vspace{0.1 cm}

\end{figure*}
\end{flushleft}
%.........................................................................


%.........................................................................
%FIGURE 2: Distributions of FA and density regarding the Lambda_1 eigenvalue
\begin{flushleft}
\begin{figure*}
\centering

  \includegraphics[trim = 2mm 2mm 5mm 10mm, clip, keepaspectratio=true,
  width=0.3\textheight]{./figures/FA_L1.pdf}
  \includegraphics[trim = 2mm 2mm 5mm 10mm, clip, keepaspectratio=true,
  width=0.3\textheight]{./figures/delta_L1.pdf}  
  
  \captionof{figure}{\small Distributions of fractional anisotropy 
  (left panel) and density field (right panel) with respect to the 
  eigenvalue $\lambda_1$ for each web scheme (T-web, red lines. V-web, 
  blue lines) as calculated over all cells of the grid. Thick central 
  lines correspond to the median and filled regions to the $50\%$ of 
  the distribution.}

  \label{fig:L1_correlations}
  \vspace{0.1 cm}

\end{figure*}
\end{flushleft}
%.........................................................................


%-------------------------------------------------------------------------
\subsection{The density-based web finder}
\label{subsec:Vweb}
%-------------------------------------------------------------------------


Although the density field is a key quantity for understanding the 
large-scale Universe, the filamentary structure of the Cosmic Web is 
poorly traced by it (see e.g. figure \ref{fig:FA_field}). In order to 
compare our new proposal based on the the fractional anisotropy as a 
tracer field of voids, we define a very basic approach for environmental 
finding based on three thresholds of the density field. 


%.........................................................................
%Table with volume filling fraction
\begin{table}[h]
\begin{flushleft}
\begin{center}
  \begin{tabular}{c  c  c  c c} \hline\hline
	\textbf{Volume}  &				&\textbf{Scheme}& \\
	\textbf{Filling} &				&				&					  &  \textbf{Threshold} \\ 
	\textbf{Fraction}&\textbf{T-web}&\textbf{V-web}	&	\textbf{Density}  &  $\bf{\delta_{th}}$  \\ \hline
	Voids			 &	$54.88\%$	&	$47.06\%$	&	$50.97\%$	 	  &	$ -0.57$			\\ 
	Sheets		     &	$33.21\%$	&	$39.54\%$	&	$36.38\%$ 	      &	$0.60$				\\
	Filaments		 &	$11.16\%$	&	$12.18\%$	&	$11.67\%$ 		  &	$8.82$				\\
	Knots			 &	$0.75\%$	&	$1.22\%$	&	$0.98\%$  		  &	--		\\ \hline\hline
  \end{tabular}  
  \captionof{table}{\small VFF for each type of environment and for each
  web scheme. VFF for the density-based scheme are defined as the 
  arithmetic mean of the T-web and the V-web. The last column corresponds 
  to the threshold values in the density field in order to obtain the 
  required VFF. Note there is not any value associated to knots as there 
  is not a higher order environment.}
  
  \label{tab:VFF}
\end{center}
\end{flushleft}
\end{table}
%.........................................................................


%.........................................................................
%FIGURE 4: FA and vissual impression
\begin{figure*}
\centering

  \includegraphics[trim = 16mm 10mm 5mm 12mm, clip, keepaspectratio=true,
  width=0.73\textheight]{./figures/cosmicweb_FA_Tweb.pdf}
  \vspace{0.1 cm}
  \includegraphics[trim = 16mm 10mm 5mm 12mm, clip, keepaspectratio=true,
  width=0.73\textheight]{./figures/cosmicweb_FA_Vweb.pdf}
  \vspace{0.1 cm}  
  \includegraphics[trim = 16mm 10mm 5mm 12mm, clip, keepaspectratio=true,
  width=0.73\textheight]{./figures/cosmicweb_density.pdf}
  
  \captionof{figure}{\small Left panels show the visual impression of the 
  Cosmic Web for each web scheme (T-web, upper panels. V-web, middle 
  panels. Density, lower panels). It can be noticed each environment 
  sketched such that voids corresponds to white, sheets to gray, filaments 
  to dark gray and knots to black regions. Right panels show the fractional 
  anisotropy field for the same slide of the simulation and for each web 
  scheme. Black regions correspond to the maxim value, i.e. FA$=1$, while 
  white and light yellow regions to FA$=0$. It is worth noting the 
  degeneration of low values of FA for knots and central regions of voids, 
  thus indicating a high isotropy for both processes. In the same way, high 
  values of FA (FA $\lesssim 1$) are consistent the anisotropic geometry 
  exhibited by filaments and very flat sheets.}

  \label{fig:FA_field}

  
\end{figure*}
%.........................................................................


In next section we shall describe an alternative approximation to select 
the threshold value $\lambda_{th}$, and as will be shown, one of its main 
advantages is the similar volume filling fraction (VFF) of each 
environment as compared between both web schemes. Using this result, we 
propose here a heuristic classification of the Cosmic Web based on 
three density thresholds assigned to each boundary (i.e. void-sheet, 
sheet-filament and filament-knot)\footnote{The progressive sequence 
void-sheet-filament-knot along any path in the Cosmic Web should be always
satisfied as each used field is smoothed. For instance, it should not be 
possible to find a knot-type cell abutting another sheet or void-type 
cell.} such that the corresponding VFF values are similar to the values 
obtained for the T-web and the V-web, specifically they are defined 
to be the arithmetic mean of both schemes.


%*************************************************************************
\section{Finding bulk voids}
\label{sec:bulk_voids}
%*************************************************************************


%-------------------------------------------------------------------------
\subsection{Fractional anisotropy as tracer of voids}
\label{subsec:FA_voids}
%-------------------------------------------------------------------------


According to the recent growing interest in studying galaxy formation in 
low-density regions as cosmological tests, classifying void regions is 
becoming an important task in cosmology. Most of those classification 
schemes for voids in cosmological simulations are based upon the density 
field, setting a cut off value below which some region becomes a void 
\SRKED{[references]}. Some more advanced classification schemes are based 
on Voronoi tessellations applied over the tracer particles of the 
simulation in order to compute the density field. Then, through a watershed 
transform, a hierarchy of void regions are found \SRKED{[references, 
ZOBOV algorithm]}.


As has been established \SRKED{[references]}, both web schemes presented 
in the previous section (V-web and T-web) for classifying the cosmic web 
present many advantages compared with classification schemes based
completely upon the density field, e.g. a more robust description of the
dynamic a kinematic of the cosmic web, a more reliable quantification of 
the visual impression, among others. With the aim of exploiting all of 
these advantages, we propose here a novel approach to classify voids in
cosmological simulations based entirely on the web schemes.


The original version of the T-web scheme \SRKED{[reference, Hahn]} was not
successful at reproducing the visual impression of the cosmic web, 
however, with the introduction of a threshold parameter \SRKED{[reference, 
Forero-Romero]}, this scheme, and even the V-web \SRKED{[reference, 
Hoffman]}, improved enormously. As this free parameter controls the visual 
impression provided by each scheme, phenomenons like percolation depends 
on it as well. Although percolation is one of the key features of the 
structure of void regions, indicating how voids are merged among them, and 
how they permeate all the cosmic web, our primal interest here is studying 
properties of single voids. Nevertheless, in the next section we shall 
analyse briefly the percolation phenomenon for both web schemes.


In order to deal with percolation of voids in our classification scheme,
we introduce the fractional anisotropy as defined in \SRKED{[reference, 
Libeskind]}.


%.........................................................................
%Fractional anisotropy
\eq{fractional_anisotropy}
{ FA = \frac{1}{\sqrt{3}}\sqrt{ \frac{ (\lambda_1 - \lambda_3)^2 + 
(\lambda_2 - \lambda_3)^2 + (\lambda_1 - \lambda_2)^2}{ \lambda_1^2 + 
\lambda_2^2 + \lambda_3^2} } }
%.........................................................................
where the eigenvalues are taken from any of the two web schemes. This 
index, such as it is defined, allows quantifying the local anisotropy 
degree of the cosmological environment, where $FA=0$ corresponds to highly
isotropic regions and $FA=1$ anisotropic ones.


In the figure \ref{fig:FA_field} we calculate the FA field over the 
simulation for both web schemes. The first interesting feature of this
figure is the degeneration presented for knots and central regions of 
voids, where both of them exhibit low to middle values of the FA, 
indicating a high isotropy regarding the physical properties quantified by 
each web scheme, i.e. the density field for the T-web and the peculiar 
velocity for the V-web. For the T-web, the FA field near to knots presents 
a very narrow distribution around a local minimum, whereas for the V-web 
such distribution is more spread out. This can be explained appealing to 
the low fluctuations of the density field compared with the peculiar 
velocity in highly non-linear regions like knots. For more linear regions 
like voids, the behaviour of the FA field is quite similar between both 
schemes, what is consistent with the equivalence of the T-web and the 
V-web in the linear regime \SRKED{[reference, Hoffman]}.


According to the classification scheme adopted for the cosmological 
environment, voids are regions where 
$\lambda_3\leq\lambda_2\leq\lambda_1\leq\lambda_{th}$. This implies that
the boundaries of void regions are controlled completely by the $\lambda_1$
eigenvalue of the web scheme and the threshold value. Therefore, as we 
increase the threshold value $\lambda_{th}$, all voids grow up 
progressively through contours of the $\lambda_1$ field until certain 
critical value where they are so large that the visual impression is no 
longer reproduced. Our objective here is to find a reliable quantity that 
allows to trace the geometry of void regions as classified by each web 
scheme. In the figure \ref{fig:L1_correlations} we calculate the 
distributions of the fractional anisotropy index and the density field 
regarding the $\lambda_1$ eigenvalue for both web schemes over all the 
cells of the simulation. Thick lines correspond to the median of the 
distributions, whereas coloured regions correspond to $50\%$ of the
sample, delimited by quartiles $Q_1$ and $Q_3$. 



The first important conclusion is regarding the distribution of the FA 
index, where there is an almost perfect correlation with the $\lambda_1$ 
eigenvalue for low values of it. This result can be interpreted as an 
one-dimensional tomography of void regions, where low $\lambda_1$ values 
are associated to the central regions of voids, these being the most 
isotropic structures found, with FA values close to 0. As we increase the 
$\lambda_1$ value, corresponding to progressively outer layers of void 
regions or less isotropic voids, the FA index increases as well, 
maintaining a very reliable correlation approximately until $FA=0.95$. 
This limit value of the FA can be traduced in terms of an optimal \lth, 
where we obtain $\lambda_{opt}^V = 0.175$ for the V-web scheme and 
$\lambda_{opt}^T = 0.265$ for the T-web scheme, both values consistent 
with optimal thresholds normally taken in previous works \SRKED{[references]}. 
Due to the definition of the fractional anisotropy index, it presents the 
highest values for filaments and very flat sheets, i.e. $FA\lesssim 1$.
Therefore, if we extend the $\lambda_{th}$ value beyond the optimal 
FA limit, such that the outer regions of voids becomes highly anisotropic, 
it would imply that voids are invading filaments and sheets, so the 
optimal \lth value is a limit value up to which we can have void regions. 
For other type of environment such as sheets, filaments and knots, the 
$\lambda_1$ eigenvalue does not control their spatial boundaries, so the 
correlation with the FA index is no longer valid beyond the threshold 
values, furthermore the larger dispersion of the FA distribution also 
indicates that contours of the FA field are no longer corresponding to 
contours of the $\lambda_1$ field. Nevertheless, for high $\lambda_1$ 
values, i.e. $\lambda_1>1.0$, the median value of the FA index decreases 
to lower values, indicating the presence of isotropic knots. All of this 
allows us to conclude that the distribution of the FA with respect to the 
$\lambda_1$ eigenvalue is not only an one-dimensional tomography of voids, 
but also a sort of one-dimensional projection of the global structure of 
the cosmic web, starting in highly isotropic central voids, passing 
through very anisotropic sheets and filaments, until isotropic knot 
regions.


For the distribution of the density with respect to the $\lambda_1$ 
eigenvalue, it can be appreciated an analogous behaviour, where central 
regions of voids present the most underdense values of the overall cosmic 
web. For outer layers of voids, the density field grows progressively 
until sheets and filaments are reached. However, the dispersion in the 
distributions indicates that the geometry of voids as quantified by both 
web schemes is not compatible with the density field, i.e. contours of the
$\lambda_1$ eigenvalue do not coincide with contours of the density field. 
Then, the density is not a reliable quantity to be used as tracer of our 
voids. Furthermore, another advantage of using the FA index instead of the
density is the non-monotonous behaviour of the FA median value, with a 
local maxima that allows to identify properly the boundaries of voids.


%-------------------------------------------------------------------------
\subsection{Identifying void regions through web schemes}
\label{subsec:identification}
%-------------------------------------------------------------------------


Resuming our endeavour at identifying voids in cosmological simulations, 
previous techniques based on web classification schemes usually perform a 
FOF-like algorithm over cells previously marked as voids according to some 
established criteria in order to construct bulk void regions 
\SRKED{[references]}. Although this method has some success at classifying 
voids, percolation is completely inevitable, where the only way to reduce 
it is artificially decreasing the global volume fraction of void regions 
such that they do not merge significantly each other. 


Once has been determined the reliability of the FA index for tracing 
the geometry of voids, our novel proposal here is rather using the FA 
field for classifying void regions. As was concluded in the previous 
subsection, the geometry of voids is completely traced by contours of the
FA field, where central parts of voids and high density knot regions 
exhibit particularly low values of the FA index. Therefore, through a 
watershed transform all voids are classified, where each single void 
region corresponds to the basin of a local minimum of the FA field, where
those local minimums are restricted to be embedded into a type-void cell
in order to avoid degeneracy with knots.




%*************************************************************************
\section{Properties of voids}
\label{sec:properties}
%*************************************************************************


Once defined our method to classify bulk voids based upon web 
classification schemes of the cosmic web, we proceed to analyse some 
physical properties in order to compare their consistency with the 
geometry of voids as quantified by our method and by density-based schemes.
Next, through the reduced inertia tensor we quantify the shape distribution 
of voids. Finally, we compute numerical radial profiles of density and 
peculiar velocity of bulk voids.


%-------------------------------------------------------------------------
\subsection{Statistics of halos in voids}
\label{subsec:shape_voids}
%-------------------------------------------------------------------------


One of the main challenges in observational void finding is the discrete 
nature of galaxy surveys

 we calculate contours of discrete fields like the median mass and 
the local number of local dark matter halos and

, like the inertia values,
the density and peculiar velocities profiles as calculated over the grid 
and profiles of number of halos.


%-------------------------------------------------------------------------
\subsection{Shape of voids}
\label{subsec:shape_voids}
%-------------------------------------------------------------------------


Quantifying the shape of voids is gaining importance due to cosmological 
tests such as the Alcock-Paczynski test \SRKED{[Sutter et al 2012]}, so 
we compute here the reduced inertia tensor through the next expression in 
order to determine shape distributions of bulk voids.


%.........................................................................
%Reduced inertia tensor
\eq{ReducedIntertia}
{ \tau_{ij} = \sum_l \frac{ x_{l,i}x_{l,j}  }{R_l^2} }
%.........................................................................
where $l$ is an index associated to each cell of the current region, 
$i$ and $j$ indexes run over each spatial direction and finally 
$R_l$ is defined as $R_l^2 = x_{l,1}^2 + x_{l,2}^2 + x_{l,3}^2$. All 
positions are measured from the respective geometric center of each void.


The eigenvalues of the reduced inertia tensor, i.e. the principal moments
of inertia, are used to quantify the shape of each bulk void. They are 
denoted as $\tau_1$, $\tau_2$ and $\tau_3$ such that $\tau_1 \leq \tau_2
\leq \tau_3$. In Figure \ref{fig:distro_inertia} we show the computed
distributions for $\tau_1/\tau_2$ and $\tau_2/\tau_3$ for voids larger 
than 8 cells in order to avoid statistic fluctuations due to small regions.
We rather calculate histograms for these ratio quantities instead of each 
single value in order to avoid using an arbitrary normalization. For both 
schemes, it can be noticed that the shape distribution is completely 
spread out, thereby indicating a non-preferred geometry of void regions, 
which is in agreement with the well established high anisotropy of matter 
flows associated to this type of region. 


For a better quantification, we also perform a classification of the shape 
of voids by setting a threshold in the analysed ratio quantities. An 
anisotropic or tri-axial shape correspond to voids where $\tau_1/\tau_2 < 
0.7$ and $\tau_2/\tau_3 < 0.7$, where there is not any symmetry among the
principal directions. We find about $57.2\% \sim 61.0\%$ of total voids 
consistent with this shape, for the T-web and V-web respectively. A 
pancake or quasi-oblate shape is associated to voids where $\tau_1/\tau_2 
< 0.7$ and $\tau_2/\tau_3 > 0.7$. We found $13.1\% \sim 17.9\%$ of 
consistent voids. Filamentary or quasi-prolate voids satisfy $\tau_1/\tau_2 
> 0.7$ and $\tau_2/\tau_3 < 0.7$, with $25.4\% \sim 18.1\%$ of all voids.
Finally, isotropic or quasi-spheric voids are found when $\tau_1/\tau_2 
> 0.7$ and $\tau_2/\tau_3 > 0.7$, with $4.2\% \sim 3.1\%$ of total voids 
compatible with this shape. The threshold value of $0.7$ adopted here for
the ratios of the moments of inertia is just for illustrative purposes, 
where such distinction is rather fuzzy and continuous. However, the 
previous analysis allows us to conclude that voids are quite asymmetric 
structures.



%-------------------------------------------------------------------------
\subsection{Density profile of voids}
\label{subsec:density_voids}
%-------------------------------------------------------------------------


Describing the density profiles of voids is quite important in order to 
compare and match simulation with observational surveys, allowing possible
constrains for different cosmology models \SRKED{[Hamaous, et.al 2014]}. 
Here, and taking into account the previous results, we rather use an 
ellipsoidal approximation to describe and fit the shape of bulk voids, so 
we use the next ellipsoidal radial coordinate to describe density profiles.


%.........................................................................
%Ellipsoidal radial coordinate
\eq{radial_coordinate}
{
r^2 = \frac{x^2}{\tau_1^2} + \frac{y^2}{\tau_2^2} + \frac{z^2}{\tau_3^2},
\ \ \ \ 0\leq r \leq 1
}
%.........................................................................
where we take the principal moments of inertia $\{\tau_i \}$ as the 
lengths of the principal axes of the ellipsoid and each one of the 
cartesian coordinates as measured in the rotated frame of each void.


We use the same analytic density profile that \SRKED{[Hamaous, et.al 2014]} 
to fit the numerical density profiles of our voids.


%.........................................................................
%Density profile
\eq{density_profile}
{
\delta_v(r) = \delta_c\frac{1-(r/r_s)^\alpha}{1+(r/r_v)^\beta}
}
%.........................................................................



%*************************************************************************
\section{Conclusions}
\label{sec:conclusions}
%*************************************************************************


%*************************************************************************
\section*{Acknowledgments}  
%*************************************************************************


\bibliographystyle{latex/mn2e}
\bibliography{references}

%.........................................................................
%FIGURE 4: volume functions
\begin{flushleft}
\begin{figure*}
\centering

  \includegraphics[trim = 0mm 0mm 0mm 0mm, clip, keepaspectratio=true,
  width=0.3\textheight]{./figures/voids_regions_volume_all.pdf}
  
  \captionof{figure}{\small Volume functions of voids catalogued by each 
  used scheme. Left panel (watershed transform over the FA field of the T-web 
  scheme). Central panel (over the FA field of the V-web scheme). Right panel 
  (over the density field). Gray curves correspond to voids without boundary 
  removal whereas black curves are associated to voids merged through boundary 
  removal process. Dotted lines correspond to original continuous fields, 
  while segmented lines correspond to fields with a 1st-order median filtering 
  and continuous lines to a 2nd-order median filtering.}

  \label{fig:volume_function}
  \vspace{0.1 cm}

\end{figure*}
\end{flushleft}
%.........................................................................


%.........................................................................
%FIGURE 5: Density profile of voids for each defined scheme
\begin{flushleft}
\begin{figure*}
\centering
  \includegraphics[trim = 3mm 2mm 4mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{./figures/voids_density_TwebFAG.pdf}
  \includegraphics[trim = 3mm 2mm 4mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{./figures/voids_density_VwebFAG.pdf}
  \includegraphics[trim = 3mm 2mm 4mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{./figures/voids_density_TwebDLG.pdf}
  
  \captionof{figure}{\small Density profiles of voids for each finding 
  scheme.}

  \label{fig:VFF}
  \vspace{0.1 cm}

\end{figure*}
\end{flushleft}
%.........................................................................


%.........................................................................
%FIGURE 5: shape-distributions
\begin{flushleft}
\begin{figure*}
\centering

  \includegraphics[trim = 6mm 1mm 5mm 4mm, clip, keepaspectratio=true,
  width=0.75\textheight]{./figures/voids_inertia_tensor.pdf}
  
  \captionof{figure}{\small Volume functions of voids catalogued by each 
  used scheme. Left panel (watershed transform over the FA field of the T-web 
  scheme). Central panel (over the FA field of the V-web scheme). Right panel 
  (over the density field). Gray curves correspond to voids without boundary 
  removal whereas black curves are associated to voids merged through boundary 
  removal process. Dotted lines correspond to original continuous fields, 
  while segmented lines correspond to fields with a 1st-order median filtering 
  and continuous lines to a 2nd-order median filtering.}

  \label{fig:shape_distro}
  \vspace{0.1 cm}

\end{figure*}
\end{flushleft}
%.........................................................................

\end{document}
